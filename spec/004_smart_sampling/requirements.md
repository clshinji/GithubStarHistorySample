# 要件定義 - ハイブリッド・サンプリングと描画改善

## 1. 概要
4万件制限を突破し、10万スターを超えるリポジトリでも滑らかなグラフを描画するための新ロジック「ハイブリッド・サンプリング」を導入する。また、複数リポジトリ時の描画バグを解消する。

## 2. ユーザーストーリー
- **データ正確性**: 私は、LangChain のような 12万スターを超えるリポジトリでも、4万件以降の推移を本家のように滑らかに確認したい。
- **グラフ表示**: 私は、リポジトリを複数追加した状態でも、棒グラフや積み上げ棒グラフが正しく表示されることを期待する。

## 3. 機能要件

### 3.1 ハイブリッド・サンプリング
- **ピンポイント取得**: `stargazers` エンドポイントに対し、全スター数を分割したインデックス（例: $0, N/40, 2N/40, ...$）に対応する `page` を直接リクエストする。
- **422エラーの許容**: ページを飛ばしてリクエストすることで、GitHub API がエラーを返さずデータを返してくれる可能性を最大限に引き出す。
- **Search API による補完**: `stargazers` で取得できなかった区間について、Search API を用いて特定の日付時点のスター総数を取得し、データを補完する。

### 3.2 描画バグ修正
- **複数リポジトリ対応**: `script.js` の `updateChart` 内で、複数データセットがある場合の Chart.js の設定（特に `bar` グラフ時）を修正し、全てのデータが描画されるようにする。

## 4. 検査基準
- LangChain を追加した際、4万件目以降もデータポイントが連続し、グラフが途切れたり直線になったりしないこと。
- 3つのリポジトリ（LangChain, Mastra, CrewAI）を追加した状態で、グラフ種類を「棒グラフ」に切り替えても全てのグラフが表示されること。
